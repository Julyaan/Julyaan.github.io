---
title: 【美团面试】不开辟新的内存空间实现数组去重
date: 2017-08-20 16:12:25
tags:
- 面试
- 前端
categories: 前端
---

美团内推面试的一道题。如果没有变量限制，方法很多很多，这里面试官要求不要定义新的引用型变量
其实吧，只是不开辟一个对象或数组变量。用splice修改自身：

```javascript
function fn(resArr){
    for (var i=0;i<resArr.length;i++){
    if(resArr.indexOf(resArr[i])!==i){
      resArr.splice(i,1);//利用splice删除第二次出现的值，
	  i--;//重要！！原始数组倍删除某个元素后，后续元素索引进一，若想继续遍历，则索引-1
    }
  }
  return resArr;
}
```

当然，这样写可能并不是面试官想要的，比较这里用了indexOf，既然是考察算法基础，所以尽量不要用特定语言的一些特性。这道题，说白了就是，在空间复杂度O(1)内设计算法，尽可能也降低时间复杂度。

空间换时间，很多人都知道，用哈希表嘛，那既要保证时间复杂度低，又要保证空间复杂度为O（1）怎么做？且看下面这种方法：

思路：
> 直接在原数组上进行排序，从头开始操作，使得操作完后的数组i出现在下标为i的位置，那么有些位置可能存在多个数字，同时有些位置可能没有数字，这样必然能够找到重复的数字

这种方法能够在O（n）的时间复杂度和O(1)的空间复杂度找到重复数字：
```javascript
function duplicate(arr){
  const len = arr.length
  for(let i=0;i<len;i++){
    while(arr[i]!= undefined && arr[i] != i){
      if(arr[i] == arr[arr[i]]){
        arr[i] = undefined
      }
      const temp = arr[i]
      arr[i] = arr[temp]
      arr[temp] = temp
    }
  }
  return arr
}
```
这段代码，把重置的数字置为undefined，有的面试官可能是要求返回重复数字，有的可能是返回数组，如果是后者，在进行一遍过滤就好了。


另外面试官还问了写 缓存相关的，从磁盘缓存和304缓存的区别，为什么要同时用新鲜值和校验值双重验证。面试整体难度一般吧，但是面试官容易问到比较偏的点，所以主导聊天内容很重要。

----

另外整理下缓存相关的知识：
目前主流的浏览器缓存分为两类，强缓存和协商缓存，它们的匹配流程如下：

<!--more-->

（1）浏览器发送请求前，根据请求头的expires和cache-control判断是否命中强缓存策略，如果命中，直接从缓存获取资源，并不会发送请求。如果没有命中，则进入下一步。

（2）没有命中强缓存规则，浏览器会发送请求，根据请求头的last-modified和etag判断是否命中协商缓存，如果命中，直接从缓存获取资源。如果没有命中，则进入下一步。

（3）如果前两步都没有命中，则直接从服务端获取资源。

可以参考这篇文章：[《你应该知道的浏览器缓存知识 - 知乎专栏》](https://zhuanlan.zhihu.com/p/26029992)

chrome中，本地缓存还分为

-	from disk cache 磁盘缓存
-	from memory cache 内存缓存

