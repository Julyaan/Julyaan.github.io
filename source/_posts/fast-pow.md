---
title: 快速求幂算法分析及java实现
date: 2017-04-03 00:44:30
tags:
- 算法
- Java
- 面试
categories: 算法
---
ACM的竞赛中，经常会出现涉及到**大数模幂运算**的题目，如求解2的10000次方模100000009的结果，这就需要我们设计一种有效的求幂算法。本文将结合的以上应用场景，分析以下几种常用的求幂算法并给出java代码的实现：

- 递归方法：二分快速求幂（又叫矩阵快速幂算法）
- 非递归方法：二进制转换法

<!--more-->

----

# 二分快速求幂

这种方法的设计思想很简单：对于A的n次幂，当n为偶数时，A^n = A^(n/2) * A^(n/2)；当n为奇数时，A^n = A^(n/2) * A^(n/2) * A （其中n/2取整）。因此，直接用递归求解即可。时间复杂度为O（lgn）。这里就不再多说，贴出代码：

```java
public static long pow(int a,int n){
	if(n==0) return 1;
	if(n==1) return a;
	if(n%2==0)
		return pow(a*a,n/2);
	else
		return pow(a*a,n/2)*a;
}
```

# 二进制转换法

以上方法效率是不高的，因为函数调用的代价非常昂贵。这里我们考虑用循环的方法进行改善，举个例子：
>对于5的900次方：
>$900=2^9+2^8+2^7+2^4+2^3+2^1=512+256+128+16+8+2$
>因此计算可转化为：
>$5^{900}=5^2*2^8*5^{16}*5^{128}*5^{256}*5^{512}$
>我们可以按以下步骤求解：
>$5^2=5*5$
>$5^4=5^2*5^2$
>$5^8=5^4*5^4$
>$5^{16}=5^8*5^8$
>$5^{32}=5^{16}*5^{16}$
>$5^{64}=5^{32}*5^{32}$
>$5^{128}=5^{64}*5^{64}$
>$5^{256}=5^{128}*5^{128}$
>$5^{512}=5^{256}*5^{256}$

其实细想以下，数学原理跟第一种方法是一样的，但是在代码实现层面，我们进行了优化，看一下代码：

```java
public static double pow(double a, int n){
	double res=1;
	while(n>0){
		if((n&1)==1){  //相当于n%2 != 0
			res *= a;
		}
		a*=a;
		n>>=1;
	}
	return res;
}
```
我们知道定义long型整数的话，当结果大于2的64次方就溢出了，往往遇到大数求幂题目会给出模数，对结果进行求模处理，根据公式a^n% m=(…((a*a % m)*a%m)……）*a%m，我们对上述代码做以下改进：



```java
public static long pow(int a, int n, int m){  //m表示模数
        long res = 1;
        while (n > 0) {
            if ((n & 1) == 1)
                res = (res * a) % m;

            a = (a * a) % m;
            b >>= 1;
        }
        return res;
  }
```